(this["webpackJsonpassignment-solution"]=this["webpackJsonpassignment-solution"]||[]).push([[0],{12:function(e,t,r){e.exports={wrapper:"styles_wrapper__2MzXg",wrapper__slider:"styles_wrapper__slider__3iBXS",buttonWrapper:"styles_buttonWrapper__nLjXT",buttonWrapper_lastDay:"styles_buttonWrapper_lastDay__3OfX9",buttonWrapper__button:"styles_buttonWrapper__button__2Ccui",buttonWrapper__button_selected:"styles_buttonWrapper__button_selected__1WOsC",buttonWrapper__button_disabled:"styles_buttonWrapper__button_disabled__1PJb_",buttonWrapper__lastDayBorder:"styles_buttonWrapper__lastDayBorder__3nc4R",buttonWrapper__lastDayBorder_disabled:"styles_buttonWrapper__lastDayBorder_disabled__3Ble9"}},13:function(e,t,r){e.exports={productCard:"styles_productCard__Moz98",productCard__card:"styles_productCard__card__1uM-q",productCard__imageWrapper:"styles_productCard__imageWrapper__3v1aN",productCard__image:"styles_productCard__image__3t08U",productCard__title:"styles_productCard__title__3yXgo",productCard__link:"styles_productCard__link__2rfeS",productCard__description:"styles_productCard__description__JnWGZ",productCard__price:"styles_productCard__price__3DkT1",productCard__price_discount:"styles_productCard__price_discount__2OdPQ",productCard__price_discounted:"styles_productCard__price_discounted__3FPK8"}},16:function(e,t,r){e.exports={wrapper:"styles_wrapper__1jja1",wrapper__label:"styles_wrapper__label__GZj_L",selectWrapper:"styles_selectWrapper__2_3zl",selectWrapper__select:"styles_selectWrapper__select__309e4",selectWrapper__icon:"styles_selectWrapper__icon__3ID8F",selectWrapper__spinner:"styles_selectWrapper__spinner__qx9b4"}},20:function(e,t,r){e.exports={wrapper:"styles_wrapper__1j12K",wrapper__overlay:"styles_wrapper__overlay__16lra",wrapper__heading:"styles_wrapper__heading__1apYC"}},27:function(e,t,r){e.exports={wrapper:"styles_wrapper__1Qb_7"}},28:function(e,t,r){e.exports={label:"styles_label__3RlHN"}},29:function(e,t,r){e.exports={ellipsis:"styles_ellipsis__2J_xG",ellipsis1:"styles_ellipsis1__ES-lv",ellipsis2:"styles_ellipsis2__2kQOa",ellipsis3:"styles_ellipsis3__1yQGH"}},40:function(e,t,r){},41:function(e,t,r){"use strict";r.r(t);var a,n=r(0),c=r.n(n),s=r(18),i=r.n(s),o=r(5),l=r(27),d=r.n(l),u=r(1),_=function(){return Object(u.jsx)("footer",{className:"".concat(d.a.wrapper," bg-footer py-32"),children:Object(u.jsx)("span",{className:"text-primary-inverted fs-sm my-0",children:"\xa9 2014-2021 Tiqets Amsterdam"})})},p=r(20),b=r.n(p),f=function(){return Object(u.jsxs)("header",{className:"".concat(b.a.wrapper," px-16 py-64"),children:[Object(u.jsx)("div",{className:"".concat(b.a.wrapper__overlay," bg-header")}),Object(u.jsx)("h1",{className:"".concat(b.a.wrapper__heading," text-primary-inverted fs-xl my-0 fw-500"),children:"Plan your trip!"})]})},j=r(10),O=r(11),v=function(){return Object(o.d)()},y=o.e,m=r(4),h=r(2),g=r(14);!function(e){e.LOCATION="locationApi",e.DATE="dateApi",e.PRODUCT="productApi"}(a||(a={}));var D,N=r(7),x={API_GW:Object({NODE_ENV:"production",PUBLIC_URL:"/tiqets-fe-assignment",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_GW||"http://localhost:3001/",CURRENCY:Object({NODE_ENV:"production",PUBLIC_URL:"/tiqets-fe-assignment",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).CURRENCY||"\u20ac"},C=Object(N.d)({baseUrl:x.API_GW,prepareHeaders:function(e){return e.set("content-type","application/json"),e}}),W=Object(g.a)({reducerPath:a.DATE,baseQuery:C,endpoints:function(e){return{getAvailableDates:e.query({query:function(){return"available_dates"}})}}}),T=W.useGetAvailableDatesQuery,E=Object(g.a)({reducerPath:a.LOCATION,baseQuery:C,endpoints:function(e){return{getLocations:e.query({query:function(){return"locations"}})}}}),A=E.useGetLocationsQuery,I=function(e){return e.map((function(e){return function(e){return Object.entries(e).reduce((function(e,t){var r=Object(j.a)(t,2),a=r[0],n=r[1];return Object(O.a)(Object(O.a)({},e),{},Object(m.a)({},function(e){for(var t=e.split(/[_-]/),r="",a=1;a<t.length;a++)r+=t[a].charAt(0).toUpperCase()+t[a].slice(1);return t[0]+r}(a),n))}),{})}(e)}))},R=function(e,t){var r=e*(1-.01*t);return"".concat(x.CURRENCY).concat(r.toFixed(2))},S=Object(g.a)({reducerPath:a.PRODUCT,baseQuery:C,endpoints:function(e){return{searchProducts:e.query({query:function(e){var t=e.date,r=e.cityId;return"products?date=".concat(t,"&city_id=").concat(r)},transformResponse:function(e){return I(e)}})}}}),w=S.useSearchProductsQuery;!function(e){e.THEME="theme",e.PAGE_TRIP_PLANNER="pageTripPlanner"}(D||(D={}));var P,L,U,Y=Object(h.e)({name:D.PAGE_TRIP_PLANNER,initialState:{filters:{cityList:[]},productList:[],isDisabled:{city:!0,date:!0}},reducers:{changeCountry:function(e,t){e.filters.country=t.payload,e.filters.cityId=void 0,e.filters.date=void 0,e.isDisabled.city=!1,e.isDisabled.date=!0,e.productList=[]},changeCity:function(e,t){e.filters.cityId=t.payload,e.filters.date=void 0,e.isDisabled.date=!1,e.productList=[]},changeDate:function(e,t){e.filters.date=t.payload,e.productList=[]},setCityList:function(e,t){e.filters.cityList=t.payload},setProductList:function(e,t){e.productList=t.payload}}}),F=Y.actions,G=function(e){return e[Y.name].filters},k=function(e){return e[Y.name].productList},M=function(e){return e[Y.name].isDisabled},H=Object(h.e)({name:D.THEME,initialState:{theme:"default"},reducers:{changeTheme:function(e,t){e.theme=t.payload}}}),q=H.actions,B=Object(h.d)({onError:function(){return console.error}}),Q=Object(h.a)({reducer:(P={},Object(m.a)(P,H.name,H.reducer),Object(m.a)(P,Y.name,Y.reducer),Object(m.a)(P,E.reducerPath,E.reducer),Object(m.a)(P,W.reducerPath,W.reducer),Object(m.a)(P,S.reducerPath,S.reducer),P),middleware:function(e){return e().concat([B.middleware,E.middleware,W.middleware,S.middleware])}}),K=B.startListening;!function(e){e[e.WAITING_FOR_COUNTRY=0]="WAITING_FOR_COUNTRY",e[e.WAITING_FOR_CITY=1]="WAITING_FOR_CITY",e[e.WAITING_FOR_DATE=2]="WAITING_FOR_DATE",e[e.NOT_FOUND=3]="NOT_FOUND",e[e.READY=4]="READY"}(U||(U={}));var X=(L={},Object(m.a)(L,U.WAITING_FOR_COUNTRY,"Please select country"),Object(m.a)(L,U.WAITING_FOR_CITY,"Please select city "),Object(m.a)(L,U.WAITING_FOR_DATE,"Please select date"),Object(m.a)(L,U.NOT_FOUND,"Nothing found, please try a different date"),Object(m.a)(L,U.READY,""),L),z=function(e){return(null===e||void 0===e?void 0:e.map((function(e){var t,r=(t=e.price,"".concat(x.CURRENCY).concat(t.toFixed(2)));return{id:e.id,image:e.image,link:e.productUrl,title:e.title,description:e.summary,price:e.discountPercentage?R(e.price,e.discountPercentage):r,discountPrice:e.discountPercentage?r:void 0}})))||[]};function J(e,t){var r;t.cancelActiveListeners();var a=(null===(r=E.endpoints.getLocations.select()(t.getState()).data)||void 0===r?void 0:r[e.payload])||[],n=a.map((function(e){return{value:e[0],label:e[1]}}));t.dispatch(F.setCityList(n))}function V(){var e=v(),t=A(),r=T(),a=y(G),c=y(k),s=y(M),i=Object(n.useMemo)((function(){var e=Object.keys(t.data||{}),n=r.data||[];return Object(O.a)(Object(O.a)({},a),{},{countryList:e,availableDates:n})}),[t,r,a]),o=Object(n.useCallback)((function(t,r){e(F["change".concat(t)](r))}),[e]),l=w({cityId:a.cityId,date:a.date},{skip:!a.cityId||!a.date}),d=Object(n.useMemo)((function(){var e,t=U.WAITING_FOR_COUNTRY;return!a.date||(null===(e=l.data)||void 0===e?void 0:e.length)||l.isFetching?a.date?t=U.READY:a.cityId?t=U.WAITING_FOR_DATE:a.country&&(t=U.WAITING_FOR_CITY):t=U.NOT_FOUND,X[t]}),[l,a]),u=Object(n.useMemo)((function(){return{locations:t.isFetching,products:l.isFetching}}),[t,l]);return Object(n.useEffect)((function(){var e=function(e){var t=[e({actionCreator:F.changeCountry,effect:J})];return function(){return t.forEach((function(e){return e()}))}}(K);return function(){e()}}),[]),Object(n.useEffect)((function(){if(l.isSuccess){var t=z(l.data||[]);e(F.setProductList(t))}}),[l]),[i,o,c,d,s,u]}var Z,$,ee=r(28),te=r.n(ee),re=function(e){var t=e.id,r=void 0===t?"":t,a=e.label,n=void 0===a?"":a,c=e.children;return Object(u.jsxs)("div",{children:[Object(u.jsx)("label",{className:"".concat(te.a.label," mb-8 fs-sm ls-primary"),htmlFor:r,children:n}),c]})};!function(e){e[e.SUNDAY=0]="SUNDAY",e[e.MONDAY=1]="MONDAY",e[e.TUESDAY=2]="TUESDAY",e[e.WEDNESDAY=3]="WEDNESDAY",e[e.THURSDAY=4]="THURSDAY",e[e.FRIDAY=5]="FRIDAY",e[e.SATURDAY=6]="SATURDAY"}($||($={}));var ae,ne=(Z={},Object(m.a)(Z,$.SUNDAY,"SUN"),Object(m.a)(Z,$.MONDAY,"MON"),Object(m.a)(Z,$.TUESDAY,"TUE"),Object(m.a)(Z,$.WEDNESDAY,"WED"),Object(m.a)(Z,$.THURSDAY,"THU"),Object(m.a)(Z,$.FRIDAY,"FRI"),Object(m.a)(Z,$.SATURDAY,"SAT"),Z),ce=r(12),se=r.n(ce),ie=function(e){var t=e.originalISOString,r=e.date,a=e.day,n=e.isLastDayOfTheMonth,c=e.selected,s=void 0!==c&&c,i=e.disabled,o=void 0!==i&&i,l=e.onSelect,d=void 0===l?function(){return null}:l;return Object(u.jsxs)("div",{className:"".concat(se.a.buttonWrapper," ").concat(n&&se.a.buttonWrapper_lastDay),children:[Object(u.jsxs)("button",{className:"".concat(se.a.buttonWrapper__button," ").concat(s&&se.a.buttonWrapper__button_selected," ").concat(o&&se.a.buttonWrapper__button_disabled," bg-primary"),type:"button",onClick:function(){return d(t)},children:[Object(u.jsx)("div",{className:"fs-sm ls-primary",children:ne[a]}),Object(u.jsx)("div",{className:"fs-lg fw-500",children:r})]}),n&&Object(u.jsx)("div",{role:"separator",className:"".concat(se.a.buttonWrapper__lastDayBorder," ").concat(o&&se.a.buttonWrapper__lastDayBorder_disabled," ml-4")})]})},oe=function(e){var t=e.id,r=void 0===t?"":t,a=e.label,c=void 0===a?"":a,s=e.availableDates,i=void 0===s?[]:s,o=e.selectedDate,l=e.onSelect,d=void 0===l?function(){return null}:l,_=Object(n.useState)([]),p=Object(j.a)(_,2),b=p[0],f=p[1];return Object(n.useEffect)((function(){if(null===i||void 0===i?void 0:i.length){var e=function(e,t,r,a){var n=new Date(e),c=new Date(e);c.setDate(c.getDate()+t);for(var s=[];c>n;){var i=n.toISOString().split("T")[0],o=a===i,l=-1===r.indexOf(i),d=new Date(n);d.setDate(n.getDate()+1);var u=1===d.getDate();s.push({originalISOString:i,date:n.getDate(),day:n.getDay(),isLastDayOfTheMonth:u,selected:o,disabled:l}),n.setDate(n.getDate()+1)}return s}(i[0],7,i,o);f(e)}}),[i,o]),Object(u.jsx)(re,{id:r,label:c,children:Object(u.jsx)("div",{className:se.a.wrapper,children:Object(u.jsx)("div",{className:se.a.wrapper__slider,children:b.map((function(e){return Object(u.jsx)(ie,Object(O.a)(Object(O.a)({},e),{},{onSelect:d}),"".concat(e.date).concat(e.day))}))})})})},le=["title","titleId"];function de(){return(de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ue(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},c=Object.keys(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _e(e,t){var r=e.title,a=e.titleId,c=ue(e,le);return n.createElement("svg",de({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},c),r?n.createElement("title",{id:a},r):null,ae||(ae=n.createElement("path",{d:"M7 10L12 15L17 10H7Z",fill:"black"})))}var pe,be=n.forwardRef(_e),fe=(r.p,r(29)),je=r.n(fe),Oe=function(e){var t=e.className,r=void 0===t?"":t;return Object(u.jsx)("div",{className:r,children:Object(u.jsxs)("div",{className:je.a.ellipsis,children:[Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{})]})})},ve=r(16),ye=r.n(ve),me=function(e){var t=e.id,r=e.label,a=void 0===r?"":r,c=e.placeholder,s=void 0===c?"":c,i=e.value,o=void 0===i?"":i,l=e.options,d=void 0===l?[]:l,_=e.isPending,p=void 0===_||_,b=e.onChange,f=void 0===b?function(){return null}:b,j=Object(n.useMemo)((function(){var e=[],t="string";return(null===d||void 0===d?void 0:d.length)&&(d[0].label?t=typeof(e=d)[0].value:e=d.map((function(e){return{label:e,value:e}}))),{localOptions:e,valueType:t}}),[d]),O=j.localOptions,v=j.valueType,y=Object(n.useCallback)((function(e){var t,r=null===(t=e.target)||void 0===t?void 0:t.value;"number"===v&&(r=parseInt(r,10)),f(r)}),[v]),m=Object(n.useMemo)((function(){var e="";return(null===O||void 0===O?void 0:O.find((function(e){return e.value===o})))&&(e=null===o||void 0===o?void 0:o.toString()),e}),[o,O]);return Object(u.jsx)("div",{className:ye.a.wrapper,children:Object(u.jsx)(re,{id:t,label:a,children:Object(u.jsxs)("div",{className:ye.a.selectWrapper,children:[Object(u.jsxs)("select",{id:t,className:"".concat(ye.a.selectWrapper__select," py-16 pl-12 pr-48 fw-500"),value:m,onChange:y,name:t,children:[Object(u.jsx)("option",{value:"",disabled:!0,children:s}),O.map((function(e){return Object(u.jsx)("option",{value:e.value,children:e.label},e.value)}))]}),p?Object(u.jsx)(Oe,{className:ye.a.selectWrapper__spinner}):Object(u.jsx)(be,{className:ye.a.selectWrapper__icon})]})})})},he=r(6),ge=r.n(he),De=function(e){var t,r,a=e.filters,c=e.setFilters,s=e.isDisabled,i=e.isPending,o=Object(n.useRef)(null);return t=o,r=ge.a.plannerWrapper_affix,Object(n.useEffect)((function(){var e=t.current,a=e.parentElement,n=e.offsetHeight,c=function(){(document.documentElement.scrollTop||document.body.scrollTop)>=n?(e.classList.add(r),a.style.paddingTop="".concat(e.clientHeight,"px"),a.style.height="auto"):(e.classList.remove(r),a.style.paddingTop="",a.style.height="")};return window.addEventListener("scroll",c),function(){window.removeEventListener("scroll",c)}}),[]),Object(u.jsxs)("div",{ref:o,className:ge.a.plannerWrapper__filter,children:[Object(u.jsx)("div",{className:ge.a.plannerWrapper__filterCountry,children:Object(u.jsx)(me,{id:"country-filter",label:"Country",placeholder:"Choose the country",value:a.country,options:a.countryList,onChange:function(e){return c("Country",e)},isPending:i})}),Object(u.jsx)("div",{className:"".concat(ge.a.plannerWrapper__filterCity," ").concat(s.city&&ge.a.plannerWrapper_disabled),children:Object(u.jsx)(me,{id:"city-filter",label:"City",placeholder:"Choose the city",value:a.cityId,options:a.cityList,onChange:function(e){return c("City",e)},isPending:i})}),Object(u.jsx)("div",{className:"".concat(ge.a.plannerWrapper__filterDate," ").concat(s.date&&ge.a.plannerWrapper_disabled),children:Object(u.jsx)(oe,{id:"datepicker",label:"Date",availableDates:a.availableDates,selectedDate:a.date,onSelect:function(e){return c("Date",e)}})})]})},Ne=new WeakMap;function xe(e){e.forEach((function(e){if(Ne.has(e.target)){var t=Ne.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(pe.unobserve(e.target),Ne.delete(e.target),t())}}))}function Ce(){return void 0===pe&&(pe=new IntersectionObserver(xe,{rootMargin:"100px",threshold:.15})),pe}var We=r(13),Te=r.n(We),Ee=function(e){var t,r,a=e.image,c=e.link,s=e.title,i=e.description,o=e.price,l=e.discountPrice,d=Object(n.useState)(!1),_=Object(j.a)(d,2),p=_[0],b=_[1],f=Object(n.useRef)(null);return t=f,r=function(){b(!0)},Object(n.useEffect)((function(){var e=t.current,a=Ce();return Ne.set(e,r),a.observe(e),function(){Ne.delete(e),a.unobserve(e)}}),[]),Object(u.jsx)("article",{className:Te.a.productCard,children:Object(u.jsxs)("div",{className:"".concat(Te.a.productCard__card," mr-12"),children:[Object(u.jsx)("picture",{className:Te.a.productCard__imageWrapper,ref:f,children:p&&Object(u.jsx)("img",{alt:s,className:Te.a.productCard__image,src:a,srcSet:"".concat(a," 2x")})}),Object(u.jsx)("h3",{className:"".concat(Te.a.productCard__title," fs-md fw-500 mb-0 mt-12"),children:Object(u.jsx)("a",{className:Te.a.productCard__link,href:c,target:"_blank",rel:"noreferrer",children:s})}),Object(u.jsx)("span",{className:"".concat(Te.a.productCard__description," fs-sm fw-400"),children:i}),Object(u.jsxs)("span",{className:"".concat(Te.a.productCard__price," ").concat(l&&Te.a.productCard__price_discounted," fw-500 mb-12"),children:[o,l&&Object(u.jsx)("span",{className:"".concat(Te.a.productCard__price_discount," fw-400 mb-12 ml-8"),children:l})]})]})})},Ae=function(e){var t=e.products,r=void 0===t?[]:t,a=e.alert,n=void 0===a?"":a,c=e.isPending,s=void 0===c||c;return Object(u.jsx)("div",{className:"".concat(ge.a.products," my-8"),children:n?Object(u.jsx)("span",{className:ge.a.products__alert,children:n}):s?Object(u.jsxs)("span",{className:ge.a.products__alert,children:["Loading",Object(u.jsx)(Oe,{className:ge.a.products__spinner})]}):Object(u.jsx)("div",{className:"".concat(ge.a.products__items," mt-24"),children:r.map((function(e){return Object(u.jsx)(Ee,Object(O.a)({},e),e.id)}))})})},Ie=function(){var e=V(),t=Object(j.a)(e,6),r=t[0],a=t[1],n=t[2],c=t[3],s=t[4],i=t[5];return Object(u.jsxs)("section",{className:ge.a.plannerWrapper,children:[Object(u.jsx)(De,{filters:r,setFilters:a,isDisabled:s,isPending:i.locations}),Object(u.jsx)(Ae,{products:n,alert:c,isPending:i.products})]})};function Re(e){document.documentElement.className="theme",document.documentElement.classList.add("theme--".concat(e.payload))}function Se(){var e=v();Object(n.useEffect)((function(){var t=function(e){var t=[e({actionCreator:q.changeTheme,effect:Re})];return function(){return t.forEach((function(e){return e()}))}}(K),r=window.matchMedia("(prefers-color-scheme: dark)");function a(){e(q.changeTheme(r.matches?"dark":"default"))}return a(),r.addEventListener("change",a),function(){t(),r.removeEventListener("change",a)}}),[])}var we=function(){return Se(),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(f,{}),Object(u.jsx)("main",{children:Object(u.jsx)(Ie,{})}),Object(u.jsx)(_,{})]})};r(40);i.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(o.a,{store:Q,children:Object(u.jsx)(we,{})})}),document.getElementById("root"))},6:function(e,t,r){e.exports={plannerWrapper:"styles_plannerWrapper__1MLqj",plannerWrapper__filter:"styles_plannerWrapper__filter__3aDVo",plannerWrapper__filterCountry:"styles_plannerWrapper__filterCountry__1U9rP",plannerWrapper__filterCity:"styles_plannerWrapper__filterCity__3RzNX",plannerWrapper__filterDate:"styles_plannerWrapper__filterDate__n4WWa",plannerWrapper_disabled:"styles_plannerWrapper_disabled__2mhU5",plannerWrapper_affix:"styles_plannerWrapper_affix__3l3Ek",products:"styles_products__3jEvT",products__alert:"styles_products__alert__lhhb4",products__spinner:"styles_products__spinner__3hzLI",products__items:"styles_products__items__2c62e"}}},[[41,1,2]]]);
//# sourceMappingURL=main.f3e6c191.chunk.js.map